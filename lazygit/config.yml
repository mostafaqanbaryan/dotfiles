gui:
  windowSize: "half"
# keybinding:
  # universal:
    # pushFiles: '<c-p>'
customCommands:
  - key: "c"
    context: "files"
    description: "Create new gitmoji commit"
    prompts:
      - type: "menu"
        key: "Type"
        title: "Type of change"
        options:
          - name: "âœ¨"
            value: "âœ¨"
            description: "Feature"
          - name: "ğŸ›"
            value: "ğŸ›"
            description: "BugFix"
          - name: "ğŸ¨"
            value: "ğŸ¨"
            description: "Changed"
          - name: "ğŸ”’ï¸"
            value: "ğŸ”’ï¸"
            description: "Security"
          - name: "â¬†ï¸"
            value: "â¬†ï¸"
            description: "Bumped"
          - name: "ğŸš§"
            value: "ğŸš§"
            description: "WIP"
          - name: "ğŸ”¥"
            value: "ğŸ”¥"
            description: "Removed"
          - name: "ğŸ‰"
            value: "ğŸ‰"
            description: "New project"
      - type: "input"
        title: "Task Id"
        key: "TaskId"
        suggestions:
          command: "echo {{.SelectedLocalBranch.Name}} | sed 's/^\\(bugFix\\|hotFix\\|feature\\)\\/T\\([0-9]*\\)\\-.*$/\\2/'"
      - type: "input"
        title: "Message"
        key: "Message"
        initialValue: ""
      - type: "menu"
        key: "Flag"
        title: "Flag of commit"
        options:
          - name: "no flag"
            value: ""
            description: "Commit with no extra flags"
          - name: "--no-verify"
            value: "--no-verify"
            description: "Commit with --no-verify flag"

    command: "sh ~/dotfiles/lazygit/commit.sh {{.Form.Type | quote}} {{.Form.TaskId | quote}} {{.Form.Message | quote}} {{.Form.Flag}}"
    loadingText: "Commiting..."

  - key: "n"
    context: "localBranches"
    description: "Create new branch"
    prompts:
      - type: "menu"
        key: "Type"
        title: "Type of change"
        options:
          - name: "âœ¨"
            value: "feature"
            description: "Feature"
          - name: "ğŸ›"
            value: "bugFix"
            description: "BugFix"
          - name: "ğŸš‘ï¸"
            value: "hotFix"
            description: "HotFix"
      - type: "input"
        title: "Task Id"
        key: "TaskId"
        initialValue: ""
      - type: "input"
        title: "Branch name"
        key: "Name"
        initialValue: ""
        suggestions:
          preset: "branches"
    command: "git checkout -b \"$(test -n {{.Form.TaskId}} && echo {{.Form.Type}}/T{{.Form.TaskId}}-{{.Form.Name}} || echo {{.Form.Type}}/{{.Form.Name}})\""
    loadingText: "Checking out to the new branch..."

  - key: "<c-p>"
    context: "global"
    description: "Push"
    prompts:
      - type: "confirm"
        title: "Merge request"
        body: "Create a merge request in Gitlab?"
      - type: "input"
        title: "Target branch name"
        key: "Target"
        initialValue: "develop"
        suggestions:
          preset: 'branches'

    command: "git remote get-url origin | grep gitlab && git push -u origin HEAD -o merge_request.create -o merge_request.target={{.Form.Target}} -o merge_request.title='{{.SelectedLocalBranch.Name}}' || git push -u origin HEAD"
    loadingText: "Pushing..."
